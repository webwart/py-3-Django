<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Alternative column ordering &mdash; django-tables2 2.4.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Column and row attributes" href="column-attributes.html" />
    <link rel="prev" title="Alternative column data" href="custom-data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> django-tables2
          </a>
              <div class="version">
                2.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="table-data.html">Populating a table with data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Customization</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="custom-data.html">Alternative column data</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Alternative column ordering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ordering-by-accessors">Ordering by accessors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#table-order-foo-methods"><code class="xref py py-meth docutils literal notranslate"><span class="pre">table.order_FOO()</span></code> methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-column-order-on-custom-columns">Using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Column.order()</span></code> on custom columns</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="column-attributes.html">Column and row attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="column-headers-and-footers.html">Customizing headers and footers</a></li>
<li class="toctree-l1"><a class="reference internal" href="swapping-columns.html">Swapping the position of columns</a></li>
<li class="toctree-l1"><a class="reference internal" href="pagination.html">Pagination</a></li>
<li class="toctree-l1"><a class="reference internal" href="table-mixins.html">Table Mixins</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom-rendering.html">Customizing table style</a></li>
<li class="toctree-l1"><a class="reference internal" href="query-string-fields.html">Query string fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="localization-control.html">Controlling localization</a></li>
<li class="toctree-l1"><a class="reference internal" href="generic-mixins.html">Class Based Generic Mixins</a></li>
<li class="toctree-l1"><a class="reference internal" href="pinned-rows.html">Pinned rows</a></li>
<li class="toctree-l1"><a class="reference internal" href="filtering.html">Filtering data in your table</a></li>
<li class="toctree-l1"><a class="reference internal" href="export.html">Exporting table data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reference.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade-changelog.html">Upgrading and change log</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">django-tables2</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Alternative column ordering</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/pages/ordering.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="alternative-column-ordering">
<h1>Alternative column ordering<a class="headerlink" href="#alternative-column-ordering" title="Permalink to this headline">¶</a></h1>
<p>When using QuerySet data, one might want to show a computed value which is not
in the database. In this case, attempting to order the column will cause an
exception:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># models.py</span>
<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">family_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">family_name</span><span class="p">)</span>

<span class="c1"># tables.py</span>
<span class="k">class</span> <span class="nc">PersonTable</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">Table</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">Column</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">table</span> <span class="o">=</span> <span class="n">PersonTable</span><span class="p">(</span><span class="n">Person</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table</span><span class="o">.</span><span class="n">order_by</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># will result in:</span>
<span class="go">FieldError: Cannot resolve keyword &#39;name&#39; into field. Choices are: first_name, family_name</span>
</pre></div>
</div>
<p>To prevent this, django-tables2 allows two ways to specify custom ordering:
accessors and <code class="xref py py-meth docutils literal notranslate"><span class="pre">order_FOO()</span></code> methods.</p>
<section id="ordering-by-accessors">
<span id="order-by-accessors"></span><h2>Ordering by accessors<a class="headerlink" href="#ordering-by-accessors" title="Permalink to this headline">¶</a></h2>
<p>You can supply an <code class="docutils literal notranslate"><span class="pre">order_by</span></code> argument containing a name or a tuple of the
names of the columns the database should use to sort it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PersonTable</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">Table</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">order_by</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;family_name&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><a class="reference internal" href="api-reference.html#django_tables2.utils.Accessor" title="django_tables2.utils.Accessor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Accessor</span></code></a> syntax can be used as well, as long as they point to a model field.</p>
<p>If ordering does not make sense for a particular column, it can be disabled via
the <code class="docutils literal notranslate"><span class="pre">orderable</span></code> argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">SimpleTable</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">Table</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">Column</span><span class="p">()</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">orderable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="table-order-foo-methods">
<span id="table-order-foo"></span><h2><code class="xref py py-meth docutils literal notranslate"><span class="pre">table.order_FOO()</span></code> methods<a class="headerlink" href="#table-order-foo-methods" title="Permalink to this headline">¶</a></h2>
<p>Another solution for alternative ordering is being able to chain functions on to
the original QuerySet. This method allows more complex functionality giving the
ability to use all of Django’s QuerySet API.</p>
<p>Adding a <code class="xref py py-obj docutils literal notranslate"><span class="pre">Table.order_FOO</span></code> method (where <code class="xref py py-obj docutils literal notranslate"><span class="pre">FOO</span></code> is the name of the column),
gives you the ability to chain to, or modify, the original QuerySet when that
column is selected to be ordered.</p>
<p>The method takes two arguments: <code class="xref py py-obj docutils literal notranslate"><span class="pre">QuerySet</span></code>, and <code class="xref py py-obj docutils literal notranslate"><span class="pre">is_descending</span></code>. The return
must be a tuple of two elements. The first being the QuerySet and the second
being a boolean; note that modified QuerySet will only be used if the boolean is
<a class="reference external" href="https://docs.python.org/dev/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.</p>
<p>For example, let’s say instead of ordering alphabetically, ordering by
amount of characters in the first_name is desired.
The implementation would look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># tables.py</span>
<span class="kn">from</span> <span class="nn">django.db.models.functions</span> <span class="kn">import</span> <span class="n">Length</span>

<span class="k">class</span> <span class="nc">PersonTable</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">Table</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">Column</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">order_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryset</span><span class="p">,</span> <span class="n">is_descending</span><span class="p">):</span>
        <span class="n">queryset</span> <span class="o">=</span> <span class="n">queryset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">(</span><span class="s2">&quot;first_name&quot;</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">((</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">is_descending</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;length&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">queryset</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>As another example, presume the situation calls for being able to order by a
mathematical expression. In this scenario, the table needs to be able to be
ordered by the sum of both the shirts and the pants. The custom column will
have its value rendered using <a class="reference internal" href="custom-data.html#table-render-foo"><span class="std std-ref">Table.render_foo methods</span></a>.</p>
<p>This can be achieved like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># models.py</span>
<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">family_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">shirts</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>
    <span class="n">pants</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">()</span>


<span class="c1"># tables.py</span>
<span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">F</span>

<span class="k">class</span> <span class="nc">PersonTable</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">Table</span><span class="p">):</span>
    <span class="n">clothing</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">Column</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Person</span>

    <span class="k">def</span> <span class="nf">render_clothing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">shirts</span> <span class="o">+</span> <span class="n">record</span><span class="o">.</span><span class="n">pants</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">order_clothing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryset</span><span class="p">,</span> <span class="n">is_descending</span><span class="p">):</span>
        <span class="n">queryset</span> <span class="o">=</span> <span class="n">queryset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="n">amount</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="s2">&quot;shirts&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="s2">&quot;pants&quot;</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">((</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">is_descending</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;amount&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">queryset</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-column-order-on-custom-columns">
<h2>Using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Column.order()</span></code> on custom columns<a class="headerlink" href="#using-column-order-on-custom-columns" title="Permalink to this headline">¶</a></h2>
<p>If you created a custom column, which also requires custom ordering like
explained above, you can add the body of your <code class="docutils literal notranslate"><span class="pre">order_foo</span></code> method to the
order method on your custom column, to allow easier reuse.</p>
<p>For example, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">PersonTable</span></code> from above could also be defined like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ClothingColumn</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">Column</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">shirts</span> <span class="o">+</span> <span class="n">record</span><span class="o">.</span><span class="n">pants</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">order</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queryset</span><span class="p">,</span> <span class="n">is_descending</span><span class="p">):</span>
        <span class="n">queryset</span> <span class="o">=</span> <span class="n">queryset</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
            <span class="n">amount</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="s2">&quot;shirts&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">F</span><span class="p">(</span><span class="s2">&quot;pants&quot;</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">((</span><span class="s2">&quot;-&quot;</span> <span class="k">if</span> <span class="n">is_descending</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;amount&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">queryset</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PersonTable</span><span class="p">(</span><span class="n">tables</span><span class="o">.</span><span class="n">Table</span><span class="p">):</span>
    <span class="n">clothing</span> <span class="o">=</span> <span class="n">ClothingColumn</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Person</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="custom-data.html" class="btn btn-neutral float-left" title="Alternative column data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="column-attributes.html" class="btn btn-neutral float-right" title="Column and row attributes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>